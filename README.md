# 📊 网页表格识别与导出器

一个强大的 Chrome 浏览器插件，自动识别网页表格，支持预览、行列多选复制，导出为 Markdown/JSON/CSV/SQL 格式。

## 🎯 解决什么问题？

- 想复制网页表格数据，却只能一行行手动选择
- 需要将表格导入 Excel，却不知如何下手
- 后台系统的表格无法直接导出
- 动态加载的表格数据难以获取

## ✨ 功能特性

### 核心功能
- 🔍 **自动识别表格** - 支持标准表格、Element UI、Ant Design 等主流框架
- 👁️ **可视化预览** - 提取前预览表格数据
- 🎯 **行列多选复制** - 鼠标拖拽选择任意矩形区域
- 📋 **多格式导出** - Markdown、JSON、CSV、SQL 四种格式
- 🌐 **动态内容支持** - 自动检测动态加载的表格

### 便捷操作
- **Shift+点击** - 快速选择大范围数据
- **Cmd/Ctrl+方向键** - 一键跳到末尾选择整列/整行
- **Cmd/Ctrl+C** - 复制选中内容
- **全屏预览** - 大表格查看更方便

### 灵活配置
- 两种悬浮按钮模式：始终显示 / 鼠标悬停显示
- 智能过滤：自动跳过布局表格，只识别数据表格
- 支持禁用指定网站

## 🚀 快速开始

### 安装方式

#### 方式一：开发者模式安装（推荐）

1. 下载或克隆本项目到本地
2. 打开 Chrome 浏览器，访问 `chrome://extensions/`
3. 开启右上角的「开发者模式」
4. 点击「加载已解压的扩展程序」
5. 选择本项目的文件夹
6. 安装完成！

#### 方式二：打包为 CRX 文件

1. 在 `chrome://extensions/` 页面，点击「打包扩展程序」
2. 选择本项目文件夹作为扩展程序根目录
3. 点击「打包扩展程序」按钮
4. 将生成的 `.crx` 文件拖拽到 Chrome 浏览器中安装

## 📖 使用说明

### 基本操作

1. **访问含有表格的网页**
   - 打开任何包含 HTML 表格的网页
   
2. **悬停表格**
   - 将鼠标移动到表格上方
   - 右上角会出现「📊 提取表格」按钮

3. **打开提取面板**
   - 点击悬浮按钮
   - 弹出功能面板

4. **预览与选择**
   - 👁️ **预览模式** - 可视化查看表格数据
   - 🎯 **多选复制** - 鼠标拖拽或 Shift+点击选择区域
   - ⌨️ **快捷键** - Cmd+方向键快速跳到末尾，Cmd+C 复制

5. **选择导出格式**
   - � **Markdown** - 直接粘贴到文档
   - 🟢 **JSON** - 程序接口对接
   - 🔵 **CSV** - Excel/表格软件打开
   - 🟣 **SQL** - 数据库导入

6. **获取数据**
   - 📋 **复制结果** - 将数据复制到剪贴板
   - 💾 **下载文件** - 下载为对应格式的文件

### 导出格式说明

#### JSON 格式
```json
[
  {
    "姓名": "张三",
    "年龄": "25",
    "职位": "工程师"
  },
  {
    "姓名": "李四",
    "年龄": "30",
    "职位": "设计师"
  }
]
```

#### CSV 格式
```csv
"姓名","年龄","职位"
"张三","25","工程师"
"李四","30","设计师"
```

#### SQL 格式
```sql
INSERT INTO table_data (姓名, 年龄, 职位) VALUES ('张三', 25, '工程师');
INSERT INTO table_data (姓名, 年龄, 职位) VALUES ('李四', 30, '设计师');
```

## 🛠️ 技术栈

- **Manifest V3** - Chrome 扩展最新版本规范
- **原生 JavaScript** - 无依赖，轻量高效
- **CSS3** - 现代化 UI 设计
- **MutationObserver API** - 监听动态内容变化

## 📁 项目结构

```
webTable/
├── manifest.json       # 插件配置文件
├── content.js         # 核心逻辑脚本
├── style.css          # 样式文件
├── icon16.png         # 16x16 图标
├── icon48.png         # 48x48 图标
├── icon128.png        # 128x128 图标
└── README.md          # 项目说明
```

## 🎨 核心功能实现

### 表格检测
- 使用 `document.querySelectorAll('table')` 扫描页面
- 通过 `MutationObserver` 监听动态加载的表格
- 为每个表格添加标识避免重复处理

### 数据提取
- 智能识别表头（`<th>` 或第一行 `<td>`）
- 逐行解析 `<tr>` 和 `<td>` 提取数据
- 支持空值和特殊字符处理

### 格式转换
- **JSON**：使用对象数组结构，格式化输出
- **CSV**：符合 RFC 4180 标准，处理引号转义
- **SQL**：自动生成 INSERT 语句，处理 NULL 和字符串转义

### UI 交互
- 非侵入式设计，不影响原网页布局
- 使用 `position: fixed/absolute` 实现浮动 UI
- 优雅的动画效果和响应式设计

## 🔧 高级特性

### 动态内容监听
使用 `MutationObserver` 自动检测页面变化：
```javascript
const observer = new MutationObserver((mutations) => {
  // 检测新添加的表格
  mutations.forEach((mutation) => {
    mutation.addedNodes.forEach((node) => {
      if (node.tagName === 'TABLE') {
        addFloatingButton(node);
      }
    });
  });
});
```

### 样式隔离
使用 CSS `all: initial` 防止样式冲突：
```css
.table-extractor-panel,
.table-extractor-panel * {
  all: initial;
}
```

## 🐛 问题排查

### 悬浮按钮不显示
- 确认页面中存在 `<table>` 元素
- 检查浏览器控制台是否有错误信息
- 尝试刷新页面

### 导出数据为空
- 检查表格是否有有效的行和列
- 确认表格不是通过 Canvas 或图片实现的

### 样式异常
- 某些网站可能有 CSP 限制
- 尝试在隐私模式下测试

## 📝 更新日志

### v1.4.0 (2024-12)
- ✅ 新增预览模式，可视化查看表格数据
- ✅ 支持行列多选复制（拖拽、Shift+点击、Cmd+方向键）
- ✅ 新增 Markdown 导出格式
- ✅ 悬浮按钮折叠菜单设计
- ✅ 两种显示模式：始终显示 / 鼠标悬停显示
- ✅ 智能过滤布局表格
- ✅ 动态表格检测优化

### v1.0.0 (2024)
- ✅ 初始版本发布
- ✅ 支持 JSON、CSV、SQL 三种格式导出
- ✅ 智能表格检测
- ✅ 动态内容支持
- ✅ 一键复制和下载功能
- ✅ 精美的中文界面

## 🤝 贡献指南

欢迎提交 Issue 和 Pull Request！

1. Fork 本项目
2. 创建特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 提交 Pull Request

## 📄 许可证

本项目采用 MIT 许可证。

## 💬 反馈与支持

如有问题或建议，欢迎：
- 提交 GitHub Issue
- 发送邮件反馈

---

**享受便捷的表格提取体验！** 🎉
